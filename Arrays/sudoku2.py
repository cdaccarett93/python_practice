import unittest


def sudoku2(grid):
    rowSet = set()
    colSet = set()
    gridSet1 = set()
    gridSet2 = set()
    gridSet3 = set()
    n = 0
    counter = 0
    c_max = len(grid) - 1
    for i in grid:
        if n >= 3 and n % 3 == 0:
            gridSet1.clear()
            gridSet2.clear()
            gridSet3.clear()
        for index, x in enumerate(i):
            val = grid[index][counter]
            val2 = grid[n][index]
            if x in rowSet or val in colSet:
                return False
            else:
                rowSet.add(x if x != '.' else None)
                colSet.add(val if val != '.' else None)
            if val2 in gridSet1 and index < 3 or val2 in gridSet2 and 3 < index < 6 or val2 in gridSet3 and index > 6:
                return False
            elif val2 == '.':
                pass
            elif index < 3:
                gridSet1.add(val2)
            elif 3 <= index <= 5:
                gridSet2.add(val2)
            else:
                gridSet3.add(val2)
        rowSet.clear()
        colSet.clear()
        if (counter == c_max):
            counter = 0
        counter += 1
        n += 1
    return True


# Testing

test1 = [[".", ".", ".", "1", "4", ".", ".", "2", "."],
         [".", ".", "6", ".", ".", ".", ".", ".", "."],
         [".", ".", ".", ".", ".", ".", ".", ".", "."],
         [".", ".", "1", ".", ".", ".", ".", ".", "."],
         [".", "6", "7", ".", ".", ".", ".", ".", "9"],
         [".", ".", ".", ".", ".", ".", "8", "1", "."],
         [".", "3", ".", ".", ".", ".", ".", ".", "6"],
         [".", ".", ".", ".", ".", "7", ".", ".", "."],
         [".", ".", ".", "5", ".", ".", ".", "7", "."]]
test2 = [[".", ".", ".", ".", "2", ".", ".", "9", "."],
         [".", ".", ".", ".", "6", ".", ".", ".", "."],
         ["7", "1", ".", ".", "7", "5", ".", ".", "."],
         [".", "7", ".", ".", ".", ".", ".", ".", "."],
         [".", ".", ".", ".", "8", "3", ".", ".", "."],
         [".", ".", "8", ".", ".", "7", ".", "6", "."],
         [".", ".", ".", ".", ".", "2", ".", ".", "."],
         [".", "1", ".", "2", ".", ".", ".", ".", "."],
         [".", "2", ".", ".", "3", ".", ".", ".", "."]]
test3 = [[".", ".", "4", ".", ".", ".", "6", "3", "."],
         [".", ".", ".", ".", ".", ".", ".", ".", "."],
         ["5", ".", ".", ".", ".", ".", ".", "9", "."],
         [".", ".", ".", "5", "6", ".", ".", ".", "."],
         ["4", ".", "3", ".", ".", ".", ".", ".", "1"],
         [".", ".", ".", "7", ".", ".", ".", ".", "."],
         [".", ".", ".", "5", ".", ".", ".", ".", "."],
         [".", ".", ".", ".", ".", ".", ".", ".", "."],
         [".", ".", ".", ".", ".", ".", ".", ".", "."]]
test4 = [[".", ".", ".", ".", ".", ".", ".", ".", "2"],
         [".", ".", ".", ".", ".", ".", "6", ".", "."],
         [".", ".", "1", "4", ".", ".", "8", ".", "."],
         [".", ".", ".", ".", ".", ".", ".", ".", "."],
         [".", ".", ".", ".", ".", ".", ".", ".", "."],
         [".", ".", ".", ".", "3", ".", ".", ".", "."],
         ["5", ".", "8", "6", ".", ".", ".", ".", "."],
         [".", "9", ".", ".", ".", ".", "4", ".", "."],
         [".", ".", ".", ".", "5", ".", ".", ".", "."]]
test5 = [[".", "9", ".", ".", "4", ".", ".", ".", "."],
         ["1", ".", ".", ".", ".", ".", "6", ".", "."],
         [".", ".", "3", ".", ".", ".", ".", ".", "."],
         [".", ".", ".", ".", ".", ".", ".", ".", "."],
         [".", ".", ".", "7", ".", ".", ".", ".", "."],
         ["3", ".", ".", ".", "5", ".", ".", ".", "."],
         [".", ".", "7", ".", ".", "4", ".", ".", "."],
         [".", ".", ".", ".", ".", ".", ".", ".", "."],
         [".", ".", ".", ".", "7", ".", ".", ".", "."]]
test6 = [["7", ".", ".", ".", "4", ".", ".", ".", "."],
         [".", ".", ".", "8", "6", "5", ".", ".", "."],
         [".", "1", ".", "2", ".", ".", ".", ".", "."],
         [".", ".", ".", ".", ".", "9", ".", ".", "."],
         [".", ".", ".", ".", "5", ".", "5", ".", "."],
         [".", ".", ".", ".", ".", ".", ".", ".", "."],
         [".", ".", ".", ".", ".", ".", "2", ".", "."],
         [".", ".", ".", ".", ".", ".", ".", ".", "."],
         [".", ".", ".", ".", ".", ".", ".", ".", "."]]
test7 = [[".", "4", ".", ".", ".", ".", ".", ".", "."],
         [".", ".", "4", ".", ".", ".", ".", ".", "."],
         [".", ".", ".", "1", ".", ".", "7", ".", "."],
         [".", ".", ".", ".", ".", ".", ".", ".", "."],
         [".", ".", ".", "3", ".", ".", ".", "6", "."],
         [".", ".", ".", ".", ".", "6", ".", "9", "."],
         [".", ".", ".", ".", "1", ".", ".", ".", "."],
         [".", ".", ".", ".", ".", ".", "2", ".", "."],
         [".", ".", ".", "8", ".", ".", ".", ".", "."]]
test8 = [[".", ".", "5", ".", ".", ".", ".", ".", "."],
         [".", ".", ".", "8", ".", ".", ".", "3", "."],
         [".", "5", ".", ".", "2", ".", ".", ".", "."],
         [".", ".", ".", ".", ".", ".", ".", ".", "."],
         [".", ".", ".", ".", ".", ".", ".", ".", "9"],
         [".", ".", ".", ".", ".", ".", "4", ".", "."],
         [".", ".", ".", ".", ".", ".", ".", ".", "7"],
         [".", "1", ".", ".", ".", ".", ".", ".", "."],
         ["2", "4", ".", ".", ".", ".", "9", ".", "."]]
test9 = [[".", ".", ".", ".", ".", ".", ".", ".", "."],
         [".", ".", ".", ".", ".", ".", ".", ".", "."],
         [".", "9", ".", ".", ".", ".", ".", ".", "1"],
         ["8", ".", ".", ".", ".", ".", ".", ".", "."],
         [".", "9", "9", "3", "5", "7", ".", ".", "."],
         [".", ".", ".", ".", ".", ".", ".", "4", "."],
         [".", ".", ".", "8", ".", ".", ".", ".", "."],
         [".", "1", ".", ".", ".", ".", "4", ".", "9"],
         [".", ".", ".", "5", ".", "4", ".", ".", "."]]
test10 = [[".", ".", ".", "2", ".", ".", "6", ".", "."],
          [".", ".", ".", "1", ".", ".", ".", ".", "."],
          [".", ".", ".", ".", ".", ".", ".", ".", "."],
          [".", ".", ".", "5", ".", "1", ".", ".", "8"],
          [".", "3", ".", ".", ".", ".", ".", ".", "."],
          [".", ".", ".", "9", ".", ".", ".", ".", "3"],
          ["4", ".", ".", ".", ".", ".", ".", ".", "."],
          [".", ".", ".", ".", ".", ".", "3", "8", "."],
          [".", ".", ".", ".", ".", ".", ".", ".", "4"]]
test11 = [[".", ".", ".", ".", "8", ".", ".", ".", "."],
          [".", ".", ".", ".", ".", ".", "5", ".", "."],
          [".", ".", ".", ".", "4", ".", ".", "2", "."],
          [".", ".", ".", "3", ".", "9", ".", ".", "."],
          [".", ".", "1", "8", ".", ".", "9", ".", "."],
          [".", ".", ".", ".", ".", "5", "1", ".", "."],
          [".", ".", "3", ".", ".", "8", ".", ".", "."],
          [".", "1", "2", ".", "3", ".", ".", ".", "."],
          [".", ".", ".", ".", ".", "7", ".", ".", "1"]]
test12 = [[".", ".", ".", ".", ".", ".", "5", ".", "."],
          [".", ".", ".", ".", ".", ".", ".", ".", "."],
          [".", ".", ".", ".", ".", ".", ".", ".", "."],
          ["9", "3", ".", ".", "2", ".", "4", ".", "."],
          [".", ".", "7", ".", ".", ".", "3", ".", "."],
          [".", ".", ".", ".", ".", ".", ".", ".", "."],
          [".", ".", ".", "3", "4", ".", ".", ".", "."],
          [".", ".", ".", ".", ".", "3", ".", ".", "."],
          [".", ".", ".", ".", ".", "5", "2", ".", "."]]
test13 = [[".", ".", ".", ".", "4", ".", "9", ".", "."],
          [".", ".", "2", "1", ".", ".", "3", ".", "."],
          [".", ".", ".", ".", ".", ".", ".", ".", "."],
          [".", ".", ".", ".", ".", ".", ".", ".", "3"],
          [".", ".", ".", "2", ".", ".", ".", ".", "."],
          [".", ".", ".", ".", ".", "7", ".", ".", "."],
          [".", ".", ".", "6", "1", ".", ".", ".", "."],
          [".", ".", "9", ".", ".", ".", ".", ".", "."],
          [".", ".", ".", ".", ".", ".", ".", "9", "."]]
test14 = [[".", "8", "7", "6", "5", "4", "3", "2", "1"],
          ["2", ".", ".", ".", ".", ".", ".", ".", "."],
          ["3", ".", ".", ".", ".", ".", ".", ".", "."],
          ["4", ".", ".", ".", ".", ".", ".", ".", "."],
          ["5", ".", ".", ".", ".", ".", ".", ".", "."],
          ["6", ".", ".", ".", ".", ".", ".", ".", "."],
          ["7", ".", ".", ".", ".", ".", ".", ".", "."],
          ["8", ".", ".", ".", ".", ".", ".", ".", "."],
          ["9", ".", ".", ".", ".", ".", ".", ".", "."]]
test15 = [[".", ".", ".", ".", ".", ".", ".", ".", "."],
          ["4", ".", ".", ".", ".", ".", ".", ".", "."],
          [".", ".", ".", ".", ".", ".", "6", ".", "."],
          [".", ".", ".", "3", "8", ".", ".", ".", "."],
          [".", "5", ".", ".", ".", "6", ".", ".", "1"],
          ["8", ".", ".", ".", ".", ".", ".", "6", "."],
          [".", ".", ".", ".", ".", ".", ".", ".", "."],
          [".", ".", "7", ".", "9", ".", ".", ".", "."],
          [".", ".", ".", "6", ".", ".", ".", ".", "."]]
test16 = [[".", ".", ".", ".", ".", ".", ".", ".", "1"],
          [".", ".", ".", ".", ".", "6", ".", ".", "."],
          ["4", ".", ".", ".", ".", ".", "3", "8", "."],
          ["7", ".", ".", ".", ".", ".", ".", ".", "."],
          [".", ".", ".", ".", "5", "3", ".", ".", "."],
          [".", ".", ".", ".", "6", "8", ".", ".", "."],
          ["3", ".", ".", "9", ".", ".", ".", ".", "."],
          [".", ".", ".", ".", ".", "2", "1", "1", "."],
          [".", ".", ".", ".", ".", ".", ".", ".", "."]]
test17 = [[".", "8", ".", ".", ".", ".", ".", ".", "."],
          [".", ".", ".", ".", "2", ".", ".", ".", "."],
          [".", "6", ".", ".", ".", ".", "1", ".", "4"],
          [".", ".", ".", "9", ".", ".", "7", ".", "."],
          [".", ".", ".", ".", ".", ".", ".", "4", "."],
          [".", ".", "1", ".", ".", "8", ".", ".", "."],
          [".", ".", ".", ".", ".", ".", ".", ".", "."],
          [".", ".", ".", ".", ".", "5", ".", "7", "."],
          [".", ".", "3", ".", ".", "5", "6", ".", "."]]
test18 = [[".", ".", ".", ".", ".", ".", ".", ".", "."],
          [".", ".", "2", ".", ".", ".", ".", ".", "."],
          [".", ".", ".", ".", ".", "2", "7", "1", "."],
          [".", ".", ".", ".", ".", ".", ".", ".", "."],
          [".", "2", ".", ".", ".", ".", ".", ".", "."],
          [".", "5", ".", ".", ".", ".", ".", ".", "."],
          [".", ".", ".", ".", "9", ".", ".", ".", "8"],
          [".", ".", ".", ".", ".", "1", "6", ".", "."],
          [".", ".", ".", ".", "6", ".", ".", ".", "."]]
test19 = [[".", ".", ".", "9", ".", ".", ".", ".", "."],
          [".", ".", ".", ".", ".", ".", ".", ".", "."],
          [".", ".", "3", ".", ".", ".", ".", ".", "1"],
          [".", ".", ".", ".", ".", ".", ".", ".", "."],
          ["1", ".", ".", ".", ".", ".", "3", ".", "."],
          [".", ".", ".", ".", "2", ".", "6", ".", "."],
          [".", "9", ".", ".", ".", ".", ".", "7", "."],
          [".", ".", ".", ".", ".", ".", ".", ".", "."],
          ["8", ".", ".", "8", ".", ".", ".", ".", "."]]
test20 = [[".", ".", ".", ".", ".", ".", "8", "3", "."],
          ["2", ".", ".", ".", ".", ".", ".", ".", "."],
          ["7", ".", ".", ".", ".", "7", ".", "9", "5"],
          [".", ".", ".", "1", ".", ".", ".", ".", "2"],
          [".", "8", ".", "9", ".", ".", ".", ".", "."],
          [".", ".", "5", "1", "9", ".", ".", ".", "."],
          ["5", ".", ".", ".", ".", ".", ".", ".", "."],
          [".", ".", ".", ".", ".", ".", ".", ".", "."],
          [".", ".", ".", ".", ".", ".", ".", ".", "."]]


class MyTest(unittest.TestCase):
    def test1_sudoku2(self):
        self.assertEqual(sudoku2(test1), True)

    def test2_sudoku2(self):
        self.assertEqual(sudoku2(test2), False)

    def test3_sudoku2(self):
        self.assertEqual(sudoku2(test3), False)

    def test4_sudoku2(self):
        self.assertEqual(sudoku2(test4), True)

    def test5_sudoku2(self):
        self.assertEqual(sudoku2(test5), True)

    def test6_sudoku2(self):
        self.assertEqual(sudoku2(test6), False)

    def test7_sudoku2(self):
        self.assertEqual(sudoku2(test7), False)

    def test8_sudoku2(self):
        self.assertEqual(sudoku2(test8), False)

    def test9_sudoku2(self):
        self.assertEqual(sudoku2(test9), False)

    def test10_sudoku2(self):
        self.assertEqual(sudoku2(test10), True)

    def test11_sudoku2(self):
        self.assertEqual(sudoku2(test11), True)

    def test12_sudoku2(self):
        self.assertEqual(sudoku2(test12), False)

    def test13_sudoku2(self):
        self.assertEqual(sudoku2(test13), True)

    def test14_sudoku2(self):
        self.assertEqual(sudoku2(test14), True)

    def test15_sudoku2(self):
        self.assertEqual(sudoku2(test15), True)

    def test16_sudoku2(self):
        self.assertEqual(sudoku2(test16), False)

    def test17_sudoku2(self):
        self.assertEqual(sudoku2(test17), False)

    def test18_sudoku2(self):
        self.assertEqual(sudoku2(test18), True)

    def test19_sudoku2(self):
        self.assertEqual(sudoku2(test19), False)

    def test20_sudoku2(self):
        self.assertEqual(sudoku2(test20), False)


unittest.main()
